class RunMalwareScanOnAttachments < ApplicationInteractor
  def call
    attachment_names.each do |attachment_name|
      attachment = context.authorization_request.public_send(attachment_name)

      MalwareScanJob.perform_later(attachment.id)
    end
  end

  private

  def attachment_names
    context.authorization_request.form.authorization_request_class.documents
  end
end

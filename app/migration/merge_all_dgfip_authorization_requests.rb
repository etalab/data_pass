class MergeAllDGFIPAuthorizationRequests
  def initialize
    @handled = []
  end

  def perform(auto: false)
    ids.each do |from_id, to_id|
      begin
        MergeAuthorizationRequests.new(from_id, to_id, auto: auto).perform
        @handled << from_id
      rescue ArgumentError
        print "Already merged or same request: #{from_id} into #{to_id}\n"
      rescue ActiveRecord::RecordNotFound => e
        print "Record not found: #{e.message}\n"
      end
    end

    print "Merged all DGFIP authorization requests: #{@handled.join(', ')}\n"
    print "Total merged: #{@handled.size}\n"
  end

  private

  def ids
    {
      2890 => 3055,
      2614 => 3240,
      2647 => 4201,
      2561 => 5055,
      1016 => 6487,
      4163 => 6580,
      5403 => 6617,
      4646 => 7526,
      5463 => 8473,
      1778 => 8995,
      3400 => 10373,
      9500 => 10461,
      9986 => 10514,
      4908 => 12336,
      9938 => 13233,
      12868 => 15540,
      10904 => 16041,
      4645 => 25909,
      5283 => 31048,
      11088 => 31049,
      25894 => 32516,
      10933 => 32602,
      15529 => 33445,
      10134 => 36602,
      10983 => 36676,
      13923 => 36685,
      13695 => 36686,
      11818 => 36851,
      21354 => 37572,
      32436 => 39037,
      10406 => 39639,
      33862 => 40394,
      9284 => 40725,
      35157 => 42154,
      7736 => 43399,
      41554 => 45044,
      40786 => 45046,
      44221 => 45761,
      39590 => 45766,
      31799 => 47027,
      41603 => 47093,
      40963 => 47341,
      39830 => 48440,
      44652 => 51215,
      40531 => 53521,
      49221 => 53652,
      49156 => 53785,
      13881 => 54079,
      40980 => 54413,
      40116 => 54497,
      12752 => 55201,
      52499 => 55743,
      50309 => 55778,
      41013 => 56436,
      52497 => 56583,
      42037 => 56863,
      54082 => 56912,
      45033 => 56949,
      50528 => 56950,
      41106 => 56964,
      44747 => 57034,
      50032 => 57083,
      56828 => 57089,
      57058 => 57155,
      57165 => 57278,
      54208 => 57314,
      41336 => 57315,
      55103 => 57371,
      47497 => 57416,
      52782 => 57435,
      44443 => 57450,
      44643 => 57491,
      55492 => 57494,
      50661 => 57499,
      52080 => 57506,
      53306 => 57630,
      56638 => 57658,
      53975 => 58017,
      52255 => 58092,
      2560 => 58098,
      56439 => 58210,
      41274 => 58343,
      56441 => 58347,
      50458 => 58375,
      49154 => 58976,
      51663 => 59366,
      51664 => 59367,
      53859 => 59562,
      55534 => 59786,
      50602 => 59926,
      46428 => 60016,
      25679 => 60223,
      55668 => 60299,
      46377 => 60736,
      55670 => 60869,
      54312 => 61014,
      54463 => 61015,
      51073 => 61269,
      59483 => 61406,
      45439 => 61611,
      40729 => 61656,
      41235 => 61712,
      40773 => 61720,
      49872 => 61765,
      56382 => 61860,
      61999 => 62022,
      62013 => 62070,
      56992 => 62099,
      53963 => 62359,
      48984 => 62616,
      6562 => 62732,
      58234 => 63245,
      61781 => 63387,
      39586 => 63401,
      2902 => 63500,
      61136 => 63670,
      52106 => 63693,
      62221 => 63857,
      44416 => 63924,
      59369 => 64034,
      59138 => 64053,
      56928 => 64145,
      53657 => 64228,
      57572 => 64253,
      61900 => 64311,
      52874 => 64418,
      21587 => 64421,
      11842 => 64424,
      63273 => 64511,
      58522 => 64550,
      50831 => 64645,
      47737 => 64719,
      41065 => 64781,
      3377 => 64792,
      48880 => 64884,
      38399 => 64935,
      57076 => 64939,
      58574 => 65024,
      59631 => 65025,
      64545 => 65083,
      58816 => 65096,
      50072 => 65114,
      64703 => 65182,
      65141 => 65261,
      60854 => 65283,
      60856 => 65284,
      60863 => 65285,
      60858 => 65291,
      44014 => 65420,
      59829 => 65427,
      64954 => 65450,
      49636 => 65531,
      58583 => 65613,
      64847 => 65673,
      64072 => 65770,
    }
  end
end

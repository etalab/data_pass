<% content_for :content_skip_link_text do %>
  Secret du webhook
<% end %>

<% content_for :skip_links do %>
  <%= skip_link("Contenu principal", "webhook-secret") %>
  <%= skip_link("Menu", "header") %>
  <%= skip_link("Pied de page", "footer") %>
<% end %>

<div class="sub-header">
  <div>
    <h1 class="fr-m-0"><%= t('.title') %></h1>
  </div>
</div>

<div id="webhook-secret">
  <div class="fr-alert fr-alert--warning fr-mb-4w">
    <h3 class="fr-alert__title"><%= t('.warning_title') %></h3>
    <p><%= t('.warning_message') %></p>
  </div>

  <div class="fr-callout fr-callout--brown-caramel">
    <p class="fr-callout__title"><%= t('.secret_label') %></p>

    <div class="fr-input-group">
      <div class="fr-input-wrap">
        <input
          type="text"
          class="fr-input"
          id="webhook-secret-value"
          value="<%= @secret %>"
          readonly
          style="font-family: monospace; font-size: 0.875rem;"
        >
      </div>
    </div>

    <button
      class="
        fr-btn fr-btn--secondary fr-btn--icon-left fr-icon-clipboard-line
        fr-mt-2w
      "
      type="button"
      onclick="copySecretToClipboard()"
    >
      <%= t('.copy_button') %>
    </button>
  </div>

  <div class="fr-mt-4w">
    <h2 class="fr-h6"><%= t('.best_practices_title') %></h2>

    <ul>
      <li><%= t('.best_practice_1') %></li>
      <li><%= t('.best_practice_2') %></li>
      <li><%= t('.best_practice_3') %></li>
    </ul>
  </div>

  <div class="fr-mt-6w">
    <%= link_to t('.back_to_webhooks'), developers_webhooks_path, class: %w[fr-btn] %>
  </div>
</div>

<script>
function copySecretToClipboard() {
  const input = document.getElementById('webhook-secret-value');
  input.select();
  document.execCommand('copy');

  const button = event.target;
  const originalText = button.textContent;
  button.textContent = '<%= t('.copied') %>';
  button.classList.add('fr-btn--success');

  setTimeout(() => {
    button.textContent = originalText;
    button.classList.remove('fr-btn--success');
  }, 2000);
}
</script>

class RunMalwareScanOnAttachments < ApplicationInteractor
  def call
    attachment_names.each do |document_type|
      attachment = context.authorization_request.public_send(document_type.name)

      Array(attachment).each do |attached|
        MalwareScanJob.perform_later(attached.id)
      end
    end
  end

  private

  def attachment_names
    context.authorization_request.form.authorization_request_class.documents
  end
end

class RunMalwareScanOnDocuments < ApplicationInteractor
  def call
    document_types.each do |document_type|
      document = context.authorization_request.public_send(document_type.name)

      Array(document).each do |doc|
        MalwareScanJob.perform_later(doc.id)
      end
    end
  end

  private

  def document_types
    context.authorization_request.form.authorization_request_class.documents
  end
end

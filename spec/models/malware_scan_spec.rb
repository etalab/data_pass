RSpec.describe MalwareScan do
  it 'has valid factories' do
    expect(build(:malware_scan)).to be_valid
  end

  describe 'purge of associated attachments' do
    let!(:attachment) { create(:active_storage_attachment) }
    let!(:malware_scan) { create(:malware_scan, attachment: attachment) }

    it 'does not raise error when purging attachments' do
      expect { malware_scan.attachment.purge }.not_to raise_error
    end
  end
end

class BackfillMalwareScanSha256Job < ApplicationJob
  def perform(malware_scan_id)
    scan = MalwareScan.find_by(id: malware_scan_id)
    return unless scan&.attachment&.blob
    return if scan.sha256.present?

    sha256 = Digest::SHA256.hexdigest(scan.attachment.blob.download)
    scan.update!(sha256: sha256)
  end
end
